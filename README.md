# Learning-based Sampling Pattern Optimization Framework
We substantially resolve the issue of the reconstruction network getting biased towards sampling patterns and optimization getting resultantly stuck at premature states in our MRI acceleration network by applying what we call stabilization which we developed based on analysis of the convergence state of the network. Also, to tackle the problem of the reconstruction network operating in image domain and possibly corrupting some acquired samples on k-space, we integrate a data consistency imposition procedure to the training procedure. We build our network upon a conditional generative adversarial network structure utilizing a compound loss function containing the adversarial loss, $L_{1}$-norm loss, and a perceptual loss based on $L_{1}$-norm of the difference of the feature maps extracted right before the second max-pooling operation of VGG16 pre-trained on ImageNet. Also, to take advantage of redundant information and dependency across different contrasts so as to increase reconstruction performance under acceleration, we build the network to perform undersampling and reconstruction in T1, T2, and PD contrasts jointly with the imposition of a joint undersampling rate. Our contributions can be summarized as follows:

• To mitigate the problem of the reconstruction parameters getting biased towards sub-optimal sampling patterns and being dependent on initialization, we propose an optimization technique called 'stabilization' based on analysis of the state of the network at convergence consisting of an epoch-based undersampling rate imposition and loss formulation strategy. We demonstrate via experiments conducted in an ablation study manner that stabilization is more robust to suboptimal pattern biases and initialization and leads to improvements on reconstruction performance measured by PSNR and SSIM metrics in all cases we examined.<br />
•	We integrate a convenient data consistency imposing procedure to the training procedure and demonstrate through experimentations that it leads to significant improvements on reconstruction performance.<br />
•	We perform optimizations of T1, T2, and PD undersampling schemes and reconstruction of T1, T2, and PD contrast images jointly with the imposition of a joint undersampling rate which we show to improve the reconstruction performance significantly as compared to individual mask optimization and reconstruction approach.<br />
•	We utilize a conditional generative adversarial network architecture with a compound loss formulation which we show to lead to improvements on reconstruction performance especially on high frequency data.<br />

To validate our contributions, we present results of our experiments designed in an ablation study manner and performed for a diverse range of cases including acceleration rates from 2 to 64, single coil and multi-coil data, magnitude image data and complex-valued data as well as synthetic data. It is seen in all the experiments that stabilization leads to improvements on numerical reconstruction quality measured by the PSNR and SSIM metrics as well as nearly perfect attainment of the theoretically known ideal sampling patterns in the synthetic datasets, which is not reached without stabilization. Also, on experiments with magnitude images from MRI data, conjugate symmetry of the k-space, which is not quite seen when stabilization is not applied, is nearly perfectly depicted on the learned undersampling patterns when stabilization is applied. Besides, the experiments demonstrate that significant improvements on numerical reconstruction quality especially on low acceleration rates are achieved when the data consistency procedure is employed. Furthermore, we show via experiments that this cGAN architecture leads to a performance improvement compared to the U-Net architecture, and joint undersampling and reconstruction leads to a performance improvement compared to individual undersampling and reconstruction.

![Image 1: The input taking screen](https://github.com/RidvanYesiloglu/SamplingPatternOptimization/blob/main/reached_masks_on_synth.png?raw=true)
<p align="center">
    Image 1: The Reached Sampling Patterns (Masks) on Synthetic Data with an Ideal Mask of Shape "B"
</p>


![Image 1: The input taking screen](https://github.com/RidvanYesiloglu/SamplingPatternOptimization/blob/main/reached_mri_reconstruction.png?raw=true)
<p align="center">
    Image 2: Representative Reconstructions Achieved at an Acceleration Rate of 64 on Brain MRI Data
</p>
